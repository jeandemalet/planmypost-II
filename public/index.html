<!DOCTYPE html>
<html lang="fr" id="htmlRoot">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organisateur de Publications</title>
    <link rel="stylesheet" href="style.css?v=1.1">
    <!-- ‚ñº‚ñº‚ñº AJOUT DE NLP.JS POUR LA G√âN√âRATION DE HASHTAGS ‚ñº‚ñº‚ñº -->
    <script src="/lib/nlp.min.js?v=1.1"></script>
    <!-- ‚ñ≤‚ñ≤‚ñ≤ FIN DE L'AJOUT ‚ñ≤‚ñ≤‚ñ≤ -->
    <!-- ‚ñº‚ñº‚ñº AJOUT DE DOMPURIFY POUR LA S√âCURIT√â XSS (LOCAL) ‚ñº‚ñº‚ñº -->
    <script src="/lib/purify.min.js?v=1.1"></script>
    <!-- ‚ñ≤‚ñ≤‚ñ≤ FIN DE L'AJOUT DOMPURIFY (LOCAL) ‚ñ≤‚ñ≤‚ñ≤ -->
    <script src="/lib/smartcrop.js?v=1.1"></script>
    <script src="exif.js?v=1.1"></script>
</head>
<body>
    <div id="loadingOverlay" style="position: fixed; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(255,255,255,0.8); z-index: 2000; display: flex; justify-content: center; align-items: center; text-align: center;">
        <p style="font-size: 1.5em; color: #333;" data-i18n="messages.loadingApp">Initialisation de l'application...</p>
    </div>

    <div class="app-container">
        <header class="app-header">
            <div id="logoPlaceholder">
                <img src="/assets/logo.png?v=1.1" alt="Organisateur de Publications Logo" id="appLogo">
            </div>

            <div class="tabs">
                <button class="tab-button" data-tab="galleries" data-i18n="tabs.galleries"><img src="/assets/gallery.png?v=1.1" alt="Galeries" class="tab-icon"> Galeries</button>
                <button class="tab-button active" data-tab="currentGallery" data-i18n="tabs.currentGallery"><img src="/assets/tri.png?v=1.1" alt="Tri" class="tab-icon"> Tri</button>
                <button class="tab-button" data-tab="cropping" data-i18n="tabs.cropping"><img src="/assets/crop.png?v=1.1" alt="Recadrage" class="tab-icon"> Recadrage</button>
                <button class="tab-button" data-tab="description" data-i18n="tabs.description"><img src="/assets/description.png?v=1.1" alt="Description" class="tab-icon"> Description</button>
                <button class="tab-button" data-tab="calendar" data-i18n="tabs.calendar"><img src="/assets/calendar.png?v=1.1" alt="Calendrier" class="tab-icon"> Calendrier</button>
                <!-- NOUVEAU BOUTON CI-DESSOUS -->
                <button class="tab-button" data-tab="publication">
                    Publication
                </button>
            </div>

            <nav id="userActionsPlaceholder">
                <div class="profile-container">
                    <button class="icon-button" id="profileButton" aria-label="Profil" data-i18n-title="buttons.profile">
                        <img src="/assets/profile.png?v=1.1" alt="Profil" class="profile-action-icon" referrerpolicy="no-referrer">
                    </button>
                    <div id="profileDropdown" class="dropdown-menu">
                        <div id="userInfo" data-i18n="messages.connectedAs">Connect√© en tant que...</div>
                        <a href="#" id="logoutLink" data-i18n="buttons.logout">D√©connexion</a>
                    </div>
                </div>
                <div class="settings-container">
                    <button class="icon-button" id="settingsButton" aria-label="Param√®tres" data-i18n-title="buttons.settings">
                        <img src="/assets/settings.png?v=1.1" alt="Param√®tres" class="profile-action-icon">
                    </button>
                    <div id="settingsDropdown" class="dropdown-menu">
                        <!-- Section Langue -->
                        <div class="dropdown-submenu-container">
                            <a href="#" id="languageSelectBtn">
                                <span data-i18n="settings.language">Langue</span>: <span id="currentLangDisplay">Fran√ßais</span>
                                <span class="submenu-arrow">‚ñ∂</span>
                            </a>
                            <div class="dropdown-submenu" id="languageOptions">
                                <!-- Les options de langue seront ins√©r√©es ici par JavaScript -->
                            </div>
                        </div>
                        
                        <div class="dropdown-divider"></div>
                        
                        <!-- Section Donn√©es -->
                        <a href="#" id="clearCacheBtn" data-i18n="settings.clearCache">Vider le cache de l'application</a>
                        <a href="#" id="cleanupBrokenImagesBtn" data-i18n="settings.cleanupBrokenImages">üßπ Nettoyer les images cass√©es</a>
                        
                        <div class="dropdown-divider"></div>
                        
                        <!-- Section Compte & Aide -->
                        <div class="dropdown-header" data-i18n="settings.accountAndHelp">Compte & Aide</div>
                        <a href="#" class="disabled" data-i18n="settings.myProfile">Mon Profil</a>
                        <a href="https://github.com/votre-nom/publication-organizer/blob/main/README.md" target="_blank" rel="noopener" data-i18n="settings.documentation">Documentation & Aide</a>
                        <a href="#" id="aboutBtn" data-i18n="settings.about">√Ä propos de Publication Organizer</a>
                    </div>
                </div>
            </nav>
        </header>

        <div id="galleries" class="tab-content">
            <div class="galleries-layout">
                <div id="galleriesListContainer">
                    <ul id="galleriesList"></ul>
                    <div class="gallery-management-controls">
                        <button id="createNewGalleryBtn" class="add-btn-green" data-i18n="buttons.addNewGallery">
                            <img src="/assets/add-button.png?v=1.1" alt="" class="btn-icon"> Nouvelle Galerie
                        </button>
                        <!-- Formulaire de cr√©ation d√©plac√© dans la liste des galeries -->
                        <form id="newGalleryForm" style="display:none;">
                            <input type="text" id="newGalleryNameInput" placeholder="Nom de la nouvelle galerie" data-i18n-placeholder="placeholders.newGalleryName">
                            <button type="submit" id="confirmNewGalleryBtn" class="small-confirm-btn" data-i18n="buttons.confirm">OK</button>
                            <button type="button" id="cancelNewGalleryBtn" class="small-cancel-btn" data-i18n="buttons.cancel">X</button>
                        </form>
                    </div>
                </div>
                <div id="galleryPreviewArea">
                    <!-- NOUVELLE BARRE DE CONTR√îLE POUR L'APER√áU -->
                    <div id="galleryPreviewControlsBar" class="controls-bar" style="display:none;">
                        <span id="galleryPreviewNameDisplay" class="gallery-title-display"></span>
                        <div class="sort-controls">
                            <select id="galleryPreviewSortOptions">
                                <option value="" disabled data-i18n="labels.sortBy">Trier par...</option>
                                <option value="name_asc" selected data-i18n="labels.sortOptions.name_asc">Nom (A-Z)</option>
                                <option value="name_desc" data-i18n="labels.sortOptions.name_desc">Nom (Z-A)</option>
                                <option value="date_desc" data-i18n="labels.sortOptions.date_desc">Date Prise (Plus R√©cente)</option>
                                <option value="date_asc" data-i18n="labels.sortOptions.date_asc">Date Prise (Plus Ancienne)</option>
                                <option value="ratio_desc" data-i18n="labels.sortOptions.ratio_desc">Ratio (Paysage > Portrait)</option>
                                <option value="ratio_asc" data-i18n="labels.sortOptions.ratio_asc">Ratio (Portrait > Paysage)</option>
                            </select>
                        </div>
                        <div id="galleryStatsArea" style="flex: 1; text-align: center; margin: 0 15px;">
                            <span id="galleryStatsLabelText">0 photo dans la galerie</span>
                        </div>
                        <button id="galleryPreviewAddNewImagesBtn" class="add-btn-green" data-i18n="buttons.add">
                            <img src="/assets/add-button.png?v=1.1" alt="" class="btn-icon"> Ajouter
                        </button>
                    </div>
                    <div id="galleriesUploadProgressContainer" class="upload-progress-area" style="display:none; margin-bottom: 10px;">
                        <span id="galleriesUploadProgressText" class="upload-progress-text-label"></span>
                        <div class="upload-progress-bar-outer">
                            <div id="galleriesUploadProgressBarInner" class="upload-progress-bar-inner">0%</div>
                        </div>
                    </div>

                    <div id="galleryPreviewGrid"></div>
                     <p id="galleryPreviewPlaceholder" data-i18n="placeholders.selectGalleryToPreview">S√©lectionnez une galerie pour voir un aper√ßu ou la charger.</p>
                </div>
            </div>
        </div>

        <div id="currentGallery" class="tab-content">
            <div class="controls-bar">
                <span id="currentGalleryNameDisplay" class="gallery-title-display"></span>
                <button id="addNewImagesBtn" class="add-btn-green" data-i18n="buttons.add">
                    <img src="/assets/add-button.png?v=1.1" alt="" class="btn-icon"> Ajouter
                </button>
                <input type="file" id="imageSelector" multiple accept="image/*" style="display: none;">
                
                <div class="zoom-controls">
                    <button id="zoomOutBtn" class="zoom-btn-round" data-i18n-title="tooltips.zoomOut">-</button>
                    <button id="zoomInBtn" class="zoom-btn-round" data-i18n-title="tooltips.zoomIn">+</button>
                </div>
                <div class="sort-controls">
                    <select id="sortOptions" data-i18n-title="labels.sortBy" title="Trier par">
                        <option value="" disabled data-i18n="labels.sortBy">Trier par...</option>
                        <option value="name_asc" selected data-i18n="labels.sortOptions.name_asc">Nom (A-Z)</option>
                        <option value="name_desc" data-i18n="labels.sortOptions.name_desc">Nom (Z-A)</option>
                        <option value="date_desc" data-i18n="labels.sortOptions.date_desc">Date Prise (Plus R√©cente)</option>
                        <option value="date_asc" data-i18n="labels.sortOptions.date_asc">Date Prise (Plus Ancienne)</option>
                        <option value="ratio_desc" data-i18n="labels.sortOptions.ratio_desc">Ratio (Paysage > Portrait)</option>
                        <option value="ratio_asc" data-i18n="labels.sortOptions.ratio_asc">Ratio (Portrait > Paysage)</option>
                    </select>
                </div>
                

                
                <div id="currentGalleryUploadProgressContainer" class="upload-progress-area" style="display:none; flex-grow:1; margin: 0 10px; max-width: 300px;">
                    <span id="currentGalleryUploadProgressText" class="upload-progress-text-label"></span>
                    <div class="upload-progress-bar-outer" style="height:12px;">
                        <div id="currentGalleryUploadProgressBarInner" class="upload-progress-bar-inner" style="height:100%; line-height:12px;">0%</div>
                    </div>
                </div>

                <div id="statsArea" style="margin-left:auto;">
                    <span id="statsLabelText">Grille: 0 | Publications: 0</span>
                </div>
            </div>

            <div class="main-editor-layout">
                <div id="imageGridContainer">
                    <button id="addPhotosPlaceholderBtn" class="add-photos-placeholder">
                        <img src="/assets/add-button.png?v=1.1" alt="" class="btn-icon"> <span class="btn-text" data-i18n="gallery.addPhotos">Ajouter des photos</span>
                    </button>
                    <div id="imageGrid"></div>
                </div>
                <div id="publicationFramesArea">
                    <!-- Le titre <h3>Publications</h3> a √©t√© supprim√© -->
                    <div id="publicationFramesContainer"></div>
                    <div class="publication-frames-actions">
                        <button id="addPublicationFrameBtn" data-i18n="buttons.add">
                             <img src="assets/add-button.png?v=1.1" alt="" class="btn-icon"> Ajouter Publication
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- =============================== -->
        <!--      ONGLET DE RECADRAGE        -->
        <!-- =============================== -->
        <div id="cropping" class="tab-content">
            <div class="cropping-layout">
                <!-- COLONNE DE GAUCHE : LISTE DES PUBLICATIONS -->
                <div id="croppingPublicationListPanel">
                    <!-- Removed title: Publications de la Galerie -->
                    <ul id="croppingPublicationList">
                    </ul>
                </div>

                <!-- COLONNE CENTRALE : CONTENU PRINCIPAL (VUE D'ENSEMBLE OU √âDITEUR) -->
                <div id="croppingEditorContainer">
                    <!-- LE S√âLECTEUR EST MAINTENANT ICI, √Ä LA PLACE DU TITRE -->
                    <div id="viewModeSwitch" class="view-mode-switch">
                        <button id="switchToGroupedViewBtn" class="active" title="Vue d'ensemble">
                            <img src="/assets/vuedensemble.png?v=1.1" alt="Vue d'ensemble" class="view-mode-icon" loading="lazy">
                        </button>
                        <button id="switchToEditorViewBtn" title="Recadrage Individuel">
                            <img src="/assets/recadrageindividuel.png?v=1.1" alt="Recadrage Individuel" class="view-mode-icon" loading="lazy">
                        </button>
                    </div>
                    
                    <div id="allPhotosGroupedViewContainer" style="display: none;">
                        <!-- Le contenu de la vue d'ensemble sera inject√© ici par JS -->
                    </div>

                    <div id="croppingEditorPanel" style="display: none;">
                        <div class="cropper-main-area">
                            <div class="cropper-canvas-container">
                                <canvas id="cropperCanvas"></canvas>
                            </div>
                            <div class="cropper-right-panel">
                                <div class="cropper-previews">
                                    <!-- Preview title removed -->
                                    <img id="cropperPreviewLeft" alt="Aper√ßu Gauche">
                                    <img id="cropperPreviewCenter" alt="Aper√ßu Milieu">
                                    <img id="cropperPreviewRight" alt="Aper√ßu Droit">
                                </div>
                                <!-- LE BLOC DE RECADRAGE AUTO A √âT√â D√âPLAC√â D'ICI... -->
                            </div>
                        </div>
                        <div class="cropper-controls">
                            <button id="cropPrevImageBtn" title="Image pr√©c√©dente" data-i18n-title="tooltips.previousImage"><img src="assets/previous.png?v=1.1" alt="Pr√©c√©dent" loading="lazy"></button>
                            <button id="cropNextImageBtn" title="Image suivante" data-i18n-title="tooltips.nextImage"><img src="assets/next.png?v=1.1" alt="Suivant" loading="lazy"></button>
                            <button id="cropFlipBtn" title="Retourner Horizontalement" data-i18n-title="tooltips.flipHorizontal"><img src="assets/turn-around.png?v=1.1" alt="Retourner" loading="lazy"></button>
                            <select id="cropAspectRatio">
                                <option value="3:4" data-i18n="cropping.aspectRatios.3:4">3:4 (Vertical)</option>
                                <option value="1:1" data-i18n="cropping.aspectRatios.1:1">1:1 (Carr√©)</option>
                                <option value="16:9" data-i18n="cropping.aspectRatios.16:9">16:9 (Paysage)</option>
                                <option value="3:2" data-i18n="cropping.aspectRatios.3:2">3:2 (Paysage)</option>
                                <option value="free" data-i18n="cropping.aspectRatios.free">Libre</option>
                            </select>
                            <button id="cropAddWhiteBarsBtn" title="Ajouter des barres blanches (format 3:4)" data-i18n-title="tooltips.addWhiteBars"><img src="assets/barres-blanches.png?v=1.1" alt="Barres Blanches"></button>
                            <button id="cropSplitLineBtn" title="Diviser l'image pour un carrousel" data-i18n-title="tooltips.splitImage"><img src="assets/split.png?v=1.1" alt="Split"></button>
                            <button id="cropDeleteBtn" title="Supprimer et passer √† la suivante" data-i18n-title="tooltips.deleteImage"><img src="assets/bin.png?v=1.1" alt="Supprimer"></button>
                            <button id="cropFinishBtn" class="primary-action" title="Terminer et appliquer les recadrages" data-i18n-title="tooltips.finishCropping"><img src="assets/confirm.png?v=1.1" alt="Terminer et Appliquer"></button>
                            <div id="cropperInfoLabel"></div>
                        </div>
                        <div id="croppingThumbnailStrip" class="cropping-thumbnail-strip"></div>
                    </div>
                    <p id="croppingEditorPlaceholder">Aucune publication s√©lectionn√©e.</p>
                </div>

                <!-- COLONNE DE DROITE : BARRE LAT√âRALE POUR LE RECADRAGE AUTO -->
                <div id="autoCropSidebar" class="cropping-sidebar-right">
                    <!-- ...VERS ICI. -->
                    <div class="auto-crop-frame">
                        <fieldset>
                            <legend data-i18n="labels.autoCropping" style="display:none;"></legend>
                            
                            <div class="auto-crop-setting">
                                <span class="setting-label" data-i18n="labels.verticalPhotos">Photos verticales</span>
                                <div class="setting-options">
                                    <input type="radio" id="v-auto" name="vertical_treatment" value="auto">
                                    <label for="v-auto" class="auto-crop-button">
                                        <img src="assets/AI.png?v=1.1" alt="Ic√¥ne Recadrage IA" class="auto-crop-icon" loading="lazy">
                                        <span class="auto-crop-label-text" data-i18n="cropping.treatments.auto">Recadrage auto</span>
                                    </label>
                                    
                                    <input type="radio" id="v-bars" name="vertical_treatment" value="whitebars">
                                    <label for="v-bars" class="auto-crop-button">
                                        <img src="assets/barres-blanches.png?v=1.1" alt="Ic√¥ne Barres Blanches" class="auto-crop-icon" loading="lazy">
                                        <span class="auto-crop-label-text" data-i18n="cropping.treatments.whitebars">Barres blanches</span>
                                    </label>
                                    
                                    <input type="radio" id="v-none" name="vertical_treatment" value="none" checked>
                                    <label for="v-none" class="auto-crop-button">
                                        <img src="assets/nerienfaire.png?v=1.1" alt="Ic√¥ne Ne rien faire" class="auto-crop-icon" loading="lazy">
                                        <span class="auto-crop-label-text" data-i18n="cropping.treatments.none">Ne rien faire</span>
                                    </label>
                                </div>
                            </div>
            
                            <div class="auto-crop-setting">
                                 <span class="setting-label" data-i18n="labels.horizontalPhotos">Photos horizontales</span>
                                 <div class="setting-options">
                                    <input type="radio" id="h-bars" name="horizontal_treatment" value="whitebars" checked>
                                    <label for="h-bars" class="auto-crop-button">
                                        <img src="assets/barres-blanches.png?v=1.1" alt="Ic√¥ne Barres Blanches" class="auto-crop-icon" loading="lazy">
                                        <span class="auto-crop-label-text" data-i18n="cropping.treatments.whitebars">Barres blanches</span>
                                    </label>
                                    
                                    <input type="radio" id="h-none" name="horizontal_treatment" value="none">
                                    <label for="h-none" class="auto-crop-button">
                                        <img src="assets/nerienfaire.png?v=1.1" alt="Ic√¥ne Ne rien faire" class="auto-crop-icon" loading="lazy">
                                        <span class="auto-crop-label-text" data-i18n="cropping.treatments.none">Ne rien faire</span>
                                    </label>
                                 </div>
                            </div>
                            <div class="auto-crop-scope-switch">
                                <input type="radio" id="cropScopeAll" name="crop_scope" value="all" checked>
                                <label for="cropScopeAll" data-i18n="messages.cropAll">Tout recadrer</label>
                                
                                <input type="radio" id="cropScopeDay" name="crop_scope" value="selection">
                                <label for="cropScopeDay" data-i18n="messages.cropSelection">S√©lection</label>
                            </div>
                            
                            <div id="publicationSelectionContainer" class="publication-selection-container" style="display: none;">
                                <div class="publication-selection-header">
                                    <span class="selection-title" data-i18n="messages.selectPublications">S√©lectionner les publications :</span>
                                    <div class="selection-actions">
                                        <button type="button" id="selectAllPublicationsBtn" class="selection-btn" data-i18n="messages.selectAll">Tout</button>
                                        <button type="button" id="deselectAllPublicationsBtn" class="selection-btn" data-i18n="messages.selectNone">Aucun</button>
                                    </div>
                                </div>
                                <div id="publicationCheckboxList" class="publication-checkbox-list">
                                    <!-- Les checkboxes seront g√©n√©r√©es dynamiquement ici -->
                                </div>
                            </div>
                            <div class="auto-crop-actions">
                                <button id="runAutoCropBtn" class="primary-action" title="Lancer le recadrage automatique" data-i18n="buttons.runAutomation">
                                    Lancer l'automatisation
                                </button>
                            </div>
                            <div id="autoCropProgress" class="auto-crop-progress" style="display: none;"></div>
                        </fieldset>
                    </div>
                </div>
            </div>
        </div>

        <div id="description" class="tab-content">
            <!-- ‚ñº‚ñº‚ñº REMPLACEZ TOUT LE BLOC <div class="description-layout"> PAR CELUI-CI ‚ñº‚ñº‚ñº -->
            <div class="description-layout">
                <div id="descriptionPublicationListPanel">
                    <ul id="descriptionMainList"></ul>
                    <h4 class="publication-list-separator">Publications Sp√©cifiques</h4>
                    <ul id="descriptionPublicationList"></ul>
                </div>
                
                <!-- Nouveau conteneur pour l'√©diteur et la colonne de raccourcis -->
                <div class="description-editor-area">
                    <div id="descriptionEditorPanel">
                        <h3 id="descriptionEditorTitle" data-i18n="placeholders.selectPublicationToDescribe">S√©lectionnez une publication pour √©diter sa description</h3>
                        <div id="descriptionEditorContent" style="display: none;">
                            <div id="descriptionImagesPreview" class="images-preview-banner"></div>
                            <div class="description-fields">
                                <!-- Label removed -->
                                <div id="descriptionEditor" contenteditable="true" class="custom-editor"
                                     role="textbox" aria-multiline="true" data-placeholder="√âcrivez votre description ici..." data-i18n-placeholder="placeholders.editorPlaceholder"></div>
                            </div>
                        </div>
                        <p id="descriptionEditorPlaceholder" data-i18n="placeholders.noPublicationSelected">Aucune publication s√©lectionn√©e.</p>
                    </div>
                    
                    <!-- Le bloc de raccourcis est maintenant ici, √† c√¥t√© de l'√©diteur -->
                    <div id="descriptionShortcuts" class="description-shortcuts">
                        <div class="shortcut-item">
                            <button data-snippet="üì∏ Photographe : " data-i18n="shortcuts.photographer">üì∏ Photographe</button>
                        </div>
                        <div class="shortcut-item is-pair">
                            <button data-snippet="üßµ Couturier : " data-i18n="shortcuts.designer_m">üßµ Couturier</button>
                            <button data-snippet="üßµ Couturi√®re : " data-i18n="shortcuts.designer_f">üßµ Couturi√®re</button>
                        </div>
                        <div class="shortcut-item is-pair">
                            <button data-snippet="‚ú® Assistant : " data-i18n="shortcuts.assistant_m">‚ú® Assistant</button>
                            <button data-snippet="‚ú® Assistante : " data-i18n="shortcuts.assistant_f">‚ú® Assistante</button>
                        </div>
                        
                        <div class="shortcut-item is-pair">
                            <button data-snippet="üíÑ Maquilleur : " data-i18n="shortcuts.makeup_m">üíÑ Maquilleur</button>
                            <button data-snippet="üíÑ Maquilleuse : " data-i18n="shortcuts.makeup_f">üíÑ Maquilleuse</button>
                        </div>
                        
                        <div class="shortcut-item is-pair">
                            <button data-snippet="‚úÇÔ∏è Coiffeur : " data-i18n="shortcuts.hairdresser_m">‚úÇÔ∏è Coiffeur</button>
                            <button data-snippet="‚úÇÔ∏è Coiffeuse : " data-i18n="shortcuts.hairdresser_f">‚úÇÔ∏è Coiffeuse</button>
                        </div>
                        <div class="shortcut-item">
                            <button data-snippet="üíÉ Sujet(s) : " data-i18n="shortcuts.subject">üíÉ Sujet(s)</button>
                        </div>
                        
                        <div class="shortcut-item">
                            <button data-snippet="üìç Lieu : " data-i18n="shortcuts.location">üìç Lieu</button>
                        </div>
                        <div class="shortcut-item-separator"></div>
                        <div class="shortcut-item">
                           <button id="generateHashtagsBtn" class="action-button" data-i18n="buttons.generateHashtags">ü§ñ G√©n√©rer les Hashtags</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ‚ñ≤‚ñ≤‚ñ≤ FIN DU REMPLACEMENT ‚ñ≤‚ñ≤‚ñ≤ -->
        </div>

        <div id="calendar" class="tab-content">
            <div class="calendar-layout">
                <div id="calendarPublicationListPanel">
                    <ul id="calendarPublicationList">
                    </ul>
                </div>
                <div id="calendar-main-content">
                    <div class="scheduler-header">
                        <div id="monthSelectorContainer">
                            <ul id="monthSelector">
                                <!-- Les mois seront g√©n√©r√©s ici par JavaScript -->
                            </ul>
                            <span id="yearLabel">2025</span>
                        </div>
                        <button id="todayBtn" data-i18n="buttons.today">Aujourd'hui</button>
                    </div>
                    <div id="calendarGrid"></div>
                </div>
                <div id="calendar-sidebar">
                    <div class="sidebar-section auto-schedule-box">
                        <h4 data-i18n="labels.autoScheduling">Planification Automatique</h4>
                        <div class="auto-schedule-options">
                            <div class="option-group">
                                <input type="radio" id="autoScheduleChrono" name="autoScheduleMode" value="chrono" checked>
                                <label for="autoScheduleChrono" title="Place les publications les unes apr√®s les autres, dans l'ordre (Publication A, Publication B, Publication C...)."><img src="/assets/chronologique.png?v=1.1" alt="Icone chronologique" class="schedule-icon" loading="lazy"/> <span data-i18n="labels.chronological">Chronologique</span></label>
                            </div>
                            <div class="option-group">
                                <input type="radio" id="autoScheduleInterlaced" name="autoScheduleMode" value="interlaced">
                                <label for="autoScheduleInterlaced" title="Place les publications en alternant les galeries, tout en respectant l'ordre chronologique de chaque galerie."><img src="/assets/aleatoire-interlace.png?v=1.1" alt="Icone al√©atoire interlac√©" class="schedule-icon" loading="lazy"/> <span data-i18n="labels.interlaced">Chronologique Interlac√©</span></label>
                            </div>
                            <div class="option-group">
                                <input type="radio" id="autoScheduleRandom" name="autoScheduleMode" value="random">
                                <label for="autoScheduleRandom" title="Place les publications de mani√®re al√©atoire sur les dates disponibles."><img src="/assets/aleatoire-2.png?v=1.1" alt="Icone al√©atoire" class="schedule-icon" loading="lazy"/> <span data-i18n="labels.random">Al√©atoire</span></label>
                            </div>
                        </div>
                        <div class="auto-schedule-settings">
                            <div class="setting-group">
                                <label for="autoSchedulePerDay" data-i18n="labels.publish">Publier</label>
                                <input type="number" id="autoSchedulePerDay" value="1" min="1" title="Nombre de publications par jour">
                                <span data-i18n="labels.every">tous les</span>
                                <input type="number" id="autoScheduleEveryXDays" value="1" min="1" title="Intervalle en jours">
                                <span data-i18n="labels.days">jour(s)</span>
                            </div>
                        </div>
                        <button id="runAutoScheduleBtn" class="primary-action" data-i18n="buttons.runAutoSchedule">Lancer la Planification</button>
                        
                        <!-- Boutons r√©organis√©s ici -->
                        <div class="global-actions-container">
                            <button id="reorganizeAllBtn" class="secondary-action" data-i18n="buttons.reorganizeAll">Tout R√©organiser</button>
                            <button id="downloadAllScheduledBtn" data-i18n="buttons.downloadAll">Tout T√©l√©charger</button>
                        </div>
                        
                        <p id="auto-schedule-info" class="sidebar-info"></p>
                    </div>

                    <!-- ‚ñº‚ñº‚ñº CORRECTION : SECTION PUBLICATIONS √Ä PLANIFIER RESTAUR√âE ‚ñº‚ñº‚ñº -->
                    <div id="unscheduledPublicationsContainer" class="sidebar-section">
                        <h4 data-i18n="labels.unscheduledPublications">Publications √† Planifier</h4>
                        <div id="unscheduledPublicationsList">
                            <!-- La liste des publications est g√©n√©r√©e ici -->
                        </div>
                        
                        <!-- SUPPRIMER LES BOUTONS D'ICI -->
                    </div>

                </div>
            </div>
            <div id="calendarContextPreviewModal" class="modal-preview">
                <h4 id="calendarContextTitle" data-i18n="messages.preview">Aper√ßu</h4>
                <div id="calendarContextImages"></div>
            </div>
        </div>

        <!-- A la fin, apr√®s la div de l'onglet calendrier -->
        <div id="publication" class="tab-content">
            <div class="publication-layout">
                <!-- PARTIE GAUCHE : MOCKUP INSTAGRAM -->
                <div id="publication-preview-panel">
                    <div class="smartphone-mockup">
                        <div class="screen">
                            <div class="ig-profile-header">
                                <!-- Ici, on simulera l'en-t√™te du profil Instagram -->
                                <div class="ig-pfp"></div>
                                <div class="ig-stats">
                                    <div><strong>152</strong> publications</div>
                                    <div><strong>1.2k</strong> abonn√©s</div>
                                    <div><strong>342</strong> abonnements</div>
                                </div>
                                <div class="ig-bio">
                                    <strong>Votre Nom</strong>
                                    <p>Photographe Professionnel</p>
                                </div>
                            </div>
                            <div id="ig-feed-grid" class="ig-grid-container">
                                <!-- La grille des publications sera g√©n√©r√©e ici par JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PARTIE DROITE : PANNEAU DE CONTR√îLE -->
                <div id="publication-control-panel">
                    <div class="control-section">
                        <h3>Connexion Instagram</h3>
                        <p>Connectez votre compte pour publier directement.</p>
                        <button id="instagram-login-btn" class="primary-action">Se connecter √† Instagram</button>
                        <div id="instagram-user-info" style="display:none;"></div>
                    </div>
                    <div class="control-section">
                        <h3>Statut des Publications</h3>
                        <ul id="instagram-status-list">
                            <!-- Les statuts des publications s'afficheront ici -->
                            <li>Aucune publication en attente.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js?v=1.1"></script>
    <script type="module" src="constants.js"></script> <!-- Centralized constants -->
    <script type="module" src="errorHandler.js"></script> <!-- Error handling system -->
    
    <!-- === D√âBUT DE LA CORRECTION : ORDRE DES SCRIPTS MODULAIRES === -->
    
    <!-- 1. Charger la classe de base en PREMIER -->
    <script type="module" src="modules/base/BaseComponent.js"></script>
    
    <!-- 2. Charger les services centraux -->
    <script type="module" src="modules/core/EventBus.js"></script>
    <script type="module" src="modules/core/StateManager.js"></script>
    
    <!-- 3. Charger les composants qui h√©ritent de BaseComponent -->
    <script type="module" src="modules/components/CroppingManager.js"></script>
    <script type="module" src="modules/components/DescriptionManager.js"></script>
    <script type="module" src="saveStatusIndicator.js"></script> <!-- D√©plac√© ici -->
    
    <!-- 4. Charger les scripts d'int√©gration en DERNIER -->
    <script type="module" src="modules/integration/ComponentLoader.js"></script>
    <script type="module" src="modules/integration/ModularPublicationOrganizer.js"></script>
    <script type="module" src="modules/modular-integration-example.js"></script>
    
    <!-- === FIN DE LA CORRECTION === -->
    
    <script src="zipExportManager.js"></script> <!-- Background ZIP export manager -->

    <!-- ‚ñº‚ñº‚ñº AJOUT DE LA MODALE POUR L'ASSISTANT HASHTAGS ‚ñº‚ñº‚ñº -->
    <div id="hashtagModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h4>Suggestions de Hashtags</h4>
            <p>Cliquez sur les hashtags que vous souhaitez retirer, puis validez.</p>
            <div id="hashtagContainer" class="hashtag-container">
                <!-- Les hashtags g√©n√©r√©s appara√Ætront ici -->
            </div>
            <div class="modal-actions">
                <button id="cancelHashtagsBtn" class="secondary-action">Annuler</button>
                <button id="insertHashtagsBtn" class="primary-action">Ins√©rer la s√©lection</button>
            </div>
        </div>
    </div>
    <!-- ‚ñ≤‚ñ≤‚ñ≤ FIN DE L'AJOUT ‚ñ≤‚ñ≤‚ñ≤ -->
    
    <!-- Global image error handler -->
    <script>
        document.addEventListener('error', function(e) {
            const elem = e.target;
            if (elem.tagName === 'IMG') {
                console.error(`Image failed to load: ${elem.src}`);
                elem.alt = 'Image failed to load';
                elem.style.backgroundColor = '#f0f0f0';
                elem.style.border = '1px dashed #ccc';
            }
        }, true);
    </script>
</body>
</html>